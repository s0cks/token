#include <gtest/gtest.h>
#include <glog/logging.h>

#include "token/sha256.h"

namespace token{
 using namespace ::testing;

 class SHA256Test : public Test{
  public:
   SHA256Test() = default;
   ~SHA256Test() override = default;
 };

 TEST_F(SHA256Test, TestSHA256){
   auto h1 = sha256::Of((const uint8_t*)"Hello World", 11);
   auto h2 = sha256::Of((const uint8_t*)"This is a test", 14);
   ASSERT_EQ(h1, sha256::FromHex("A591A6D40BF420404A011733CFB7B190D62C65BF0BCDA32B57B277D9AD9F146E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"));
   ASSERT_NE(h1, h2);
   ASSERT_EQ(h2, sha256::FromHex("C7BE1ED902FB8DD4D48997C6452F5D7E509FBCDBE2808B16BCF4EDCE4C07D14E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"));
 }
}